Exam <- readRDS("~/Research/TestRegression/Exam.rds")
View(Exam)
library(ggplot2)
states <- readRDS("~/Research/TestRegression/states.rds")
View(states)
states2<-na.omit(states)
View(states2)
model1<-lm(energy~metro,data = states2)
ggplot(states2,aes(x=metro,y=energy))+geom_point()+stat_smooth(method = "lm",se=FALSE)
summary(model1)
predictmodel=predict(model1,data=states2)
predictmodel
SSE=sum((states2$energy-predictmodel)^2)
SST=sum((states2$energy-mean(states2$energy))^2)
1-SSE/SST

model2<-lm(energy~metro+density,data=states2)
summary(model2)
model3<-lm(energy~metro+density+waste, data=states2)
summary(model3)
region<-factor(states2$region)
model4<-lm(energy~region,data=states2)

anova(model4)
aov1<-aov(energy~region,data=states2)
summary(aov1)
ggplot(states2,aes(x=factor(region),y=energy))+geom_point()
contrasts(states2$region)
model5<-lm(energy~metro*density*waste, data=states2)
summary(model5)
plot(model5)
